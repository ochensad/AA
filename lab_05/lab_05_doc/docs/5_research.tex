\chapter{Экспериментальный раздел}
\label{cha:research}
Раздел содержит результат сравнительного анализа работы конвейера, работающего на одном потоке и многопоточного конвейера, приведена таблица результатов эксперимента и дана оценка эффективности предложенной в работе реализации алгоритма.

\section{Технические характеристики}
Тестирование выполнялось на устройстве со следующими техническими характеристиками:
\begin{itemize}
        \item операционная система: macOS Ventura 13.0 [\ref{bib:11}];
        \item оперативная память: 8 Gb;
        \item процессор: Apple M1 [\ref{bib:12}].
\end{itemize}

\section{Описание системы тестирования}
Получение характеристик работы очереди осуществлялось с помощью установки штампов на начало и завершение работы каждой из лент конвейера. Работа с временными штампами продемонстрирована на листинге \ref{lst:alg:Parallel1}

\section{Постановка эксперимента}
В данном эксперименте тестируется влияние распараллеливания конвейерной обработки на время работы конвейера. Эксперимент проведен на данных типа rune, который в языке Golang является псевдонимом для целочисленного типа размерностью 32 бита [\ref{bib:7}].
Было выполнено одно снятие временных штампов. Данные не усреднялись.
Во время тестирования устройство было подключено к блоку питания и не нагружено никакими приложениями, кроме встроенных приложений окружения, окружением и системой тестирования. Оптимизация компилятора была отключена.

\section{Результаты эксперимента}
Результаты эксперимента представлены в таблице \ref{tab:timegen}.

\begin{table}[h!]
    \begin{center}
    \caption{Замеры времени работы на очереди размером 20}
    \begin{tabular}{||l|c|c|c|c|c|c||}
        \hline
        \multirow{3}{*}{№} & \multicolumn{6}{c||}{Начало обработки заявки} \\ \cline{2-7} 
        & \multicolumn{3}{c|}{Параллельно, ns} & \multicolumn{3}{c||}{Синхронно, ns.} \\ \cline{2-7} 
        & Линия 1 & Линия 2 & Линия 3 & Линия 1 & Линия 2 & Линия 3 \\ \hline
        1   & 0          & 53934      & 111522     & 0          & 40521      & 41301      \\
        2   & 42507      & 96550      & 112526     & 41805      & 83047      & 83872      \\
        3   & 87564      & 240258     & 248300     & 84239      & 124716     & 126116     \\
        4   & 133080     & 244788     & 249092     & 126667     & 167664     & 168461     \\
        5   & 174362     & 246233     & 249644     & 168860     & 209765     & 210664     \\
        6   & 214072     & 318217     & 341519     & 211164     & 256655     & 274355     \\
        7   & 261739     & 320344     & 342130     & 275205     & 323431     & 324521     \\
        8   & 302760     & 472094     & 482306     & 325112     & 366840     & 368582     \\
        9   & 348170     & 477270     & 483114     & 369605     & 413718     & 414936     \\
        10  & 389616     & 479263     & 483587     & 415422     & 463733     & 465791     \\
        11  & 429963     & 480493     & 484016     & 466713     & 507510     & 508254     \\
        12  & 470433     & 593634     & 600897     & 508604     & 548992     & 550028     \\
        13  & 516046     & 597457     & 601563     & 550442     & 590621     & 591488     \\
        14  & 556898     & 598806     & 601930     & 591959     & 632602     & 633636     \\
        15  & 596784     & 716283     & 743636     & 634021     & 674088     & 677474     \\
        16  & 641117     & 719814     & 744380     & 677841     & 718884     & 720048     \\
        17  & 680814     & 741599     & 744850     & 735219     & 777608     & 779706     \\
        18  & 722195     & 850056     & 876476     & 780280     & 852850     & 853711     \\
        19  & 767730     & 873968     & 877044     & 854184     & 894956     & 896102     \\
        20  & 808537     & 875006     & 878601     & 896482     & 936600     & 937634     \\ \hline
    \end{tabular}
    \label{tab:timegen}
    \end{center}
\end{table}
Из таблицы можно сделать вывод, что распараллеленный конвейер выполняет работу на 6\% быстрее, чем синхронный. Таблица с результатами анализа приведена ниже(\ref{tab:time-analyth}):  

\begin{table}[h!]
    \begin{center}
    \caption{Анализ временных замеров}
    \begin{tabular}{||l|l|l|l|l|l|l|l||} \cline{1-8}
        \multicolumn{2}{||c|}{Характеристика} & \multicolumn{3}{|c|}{Параллельно, ns,} & \multicolumn{3}{|c|}{Синхронно, ns.} \\ \cline{1-8}
        \multicolumn{2}{||c|}{Линия} & \multicolumn{1}{c}{1} & \multicolumn{1}{|c|}{2} & \multicolumn{1}{|c|}{3} & \multicolumn{1}{|c|}{1} & \multicolumn{1}{|c|}{2} & \multicolumn{1}{|c||}{3} \\ \cline{1-8}
        \multirow{4}{*}{Простой очереди}
        & gen. &  23807      & 700566     & 761270     & 68686      & 858165     & 891498 \\
        & min  &  0           &  0          &  0           &  1200       &  40554       & 41244     \\
        & max  &  5421       & 141752     & 141500     & 18744      & 73787      & 73762     \\
        & avg  &  1190       &  35028       & 38063      &  3434       &  42908       & 44574     \\ \cline{1-8}
        \multirow{3}{*}{\begin{tabular}[c]{@{}l@{}}Время заявки\\ в системе\end{tabular}} 
        & min & \multicolumn{3}{c|}{45238} & \multicolumn{3}{c||}{41325} \\  
        & max & \multicolumn{3}{c|}{179982} & \multicolumn{3}{c||}{73655} \\ 
        & avg & \multicolumn{3}{c|}{102424} & \multicolumn{3}{c||}{43826} \\ \hline
    \end{tabular}
    \label{tab:time-analyth}
    \end{center}
\end{table}

При распараллеливании конвейера на три потока возникает ситуация, когда простоя в очереди нет вовсе. Так же время простоя первой, второй и третьей линии больше на синхронном конвейере в $2.8, 1,2$ и $1,7$ раз, чем на параллельном соответственно.

Однако, среднее время заявки в системе на синхронном конвейере в $\approx2.3$ раза меньше, чем время заявки в синхронном конвейере. Соответственно, выигрыш происходит исключительно за счет обеспечения меньшего простоя очереди и ситуаций, когда простоя нет вовсе.


\section{Вывод}\label{sec:exp-sum}
Конвейер, реализованный на параллельных процессах обеспечивает ситуации с минимальным или вовсе отсутствующим простоем лент. Однако, за счет затрат на обеспечение реентерабельности функций, работы с атомарными операциями и буферизации потоков, в среднем заявка находится в системе дольше, чем заявка в синхронном конвейере.   
\newpage